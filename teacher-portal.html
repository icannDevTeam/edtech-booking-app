<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Teacher Portal â€“ Discovery Room Booking</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: {
              50: '#fefce8',
              100: '#fef9c3',
              200: '#fef08a',
              300: '#fde047',
              400: '#facc15',
              500: '#eab308',
              600: '#ca8a04',
              700: '#a16207',
              800: '#854d0e',
              900: '#713f12',
            },
            secondary: {
              50: '#faf5ff',
              100: '#f3e8ff',
              200: '#e9d5ff',
              300: '#d8b4fe',
              400: '#c084fc',
              500: '#a855f7',
              600: '#9333ea',
              700: '#7e22ce',
              800: '#6b21a8',
              900: '#581c87',
            },
            accent: {
              50: '#fff1f1',
              100: '#ffe1e1',
              200: '#ffc7c7',
              300: '#ff9d9d',
              400: '#ff6b6b',
              500: '#f43f5e',
              600: '#e11d48',
              700: '#be123c',
              800: '#9f1239',
              900: '#881337',
            },
          }
        }
      }
    }
  </script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
    body {
      font-family: 'Inter', sans-serif;
    }
    .card {
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
    }
    .btn-primary {
      background-image: linear-gradient(to right, #eab308, #ca8a04);
    }
    .btn-primary:hover {
      background-image: linear-gradient(to right, #ca8a04, #a16207);
    }
    .btn-secondary {
      background-image: linear-gradient(to right, #a855f7, #9333ea);
    }
    .btn-secondary:hover {
      background-image: linear-gradient(to right, #9333ea, #7e22ce);
    }
    .btn-accent {
      background-image: linear-gradient(to right, #f43f5e, #e11d48);
    }
    .btn-accent:hover {
      background-image: linear-gradient(to right, #e11d48, #be123c);
    }
  </style>
</head>
<body class="bg-gradient-to-br from-primary-50 to-primary-200 min-h-screen">
  <!-- Home/Back Button Top Right -->
  <div class="absolute top-6 right-6 z-20">
    <a href="index.html" title="Back to Booking Page" class="inline-flex items-center px-4 py-2 bg-white text-primary-700 rounded-full shadow-lg border border-primary-200 hover:bg-primary-100 transition-colors duration-200">
      <i class="fas fa-home text-xl"></i>
    </a>
  </div>
  <div class="container mx-auto px-4 py-8 max-w-4xl">
    <!-- Header with logo and title -->
    <header class="mb-8 flex flex-col items-center">
      <div class="w-16 h-16 mb-4 bg-blue-800 rounded-full flex items-center justify-center shadow-md">
        <i class="fas fa-chalkboard-teacher text-yellow-200 text-2xl"></i>
      </div>
      <h1 class="text-3xl font-bold text-yellow-200 mb-1">Discovery Room Booking</h1>
      <p class="text-yellow-100">Teacher Portal - Manage your bookings</p>
    </header>

    <!-- Auth Section -->
    <div id="authSection" class="mb-10 flex flex-col items-center">
      <div class="w-full max-w-md bg-white rounded-xl card p-8 flex flex-col gap-6">
        <div class="text-center">
          <h2 class="text-xl font-semibold text-secondary-800">Welcome back</h2>
          <p class="text-secondary-500 text-sm mt-1">Sign in to manage your bookings</p>
        </div>
        
        <div class="space-y-4">
          <!-- Sign in with Email button removed -->
          
          <div class="text-center text-secondary-600 text-sm">
            Don't have portal access yet?
          </div>
          
          <div class="flex flex-col sm:flex-row gap-2 justify-center">
            <button id="googleSignInBtn" class="px-4 py-2 btn-accent text-white rounded-lg font-medium hover:shadow-md transition-all flex items-center justify-center gap-2 w-full">
              <i class="fab fa-google"></i> Sign in with Google
            </button>
          </div>
          <div id="requestStatus" class="text-sm text-center mt-1"></div>
          <div class="text-center mt-4">
            <a href="#" id="signUpLink" class="text-blue-700 hover:underline text-sm">Don't have an account? Sign Up</a>
          </div>
  <!-- Sign Up Modal -->
  <div id="signUpModal" class="fixed inset-0 hidden items-center justify-center bg-black bg-opacity-50 z-50">
    <div class="bg-white p-6 rounded-lg shadow-lg max-w-sm w-full fade-in">
      <h2 class="text-xl font-bold text-blue-800 mb-2">Teacher Sign Up</h2>
      <form id="signUpForm" class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
          <input type="text" id="signUpName" required class="w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500" />
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
          <input type="email" id="signUpEmail" required class="w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500" />
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Subject/Role</label>
          <input type="text" id="signUpSubject" required class="w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500" />
        </div>
        <div class="flex flex-col sm:flex-row sm:justify-end gap-3 mt-4">
          <button type="button" id="cancelSignUpBtn" class="flex-1 sm:flex-none px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-100 transition">Cancel</button>
          <button type="submit" class="flex-1 sm:flex-none px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition">Submit</button>
        </div>
      </form>
      <div id="signUpStatus" class="text-sm text-center mt-2"></div>
    </div>
  </div>
        </div>
      </div>
    </div>

    <!-- Portal Section (hidden initially) -->
    <div id="portalSection" class="hidden">
      <div class="mb-6 flex flex-col sm:flex-row justify-between items-center gap-4 bg-white rounded-xl card p-4">
        <div>
          <h2 class="text-xl font-semibold text-secondary-800">My Bookings Dashboard</h2>
          <p class="text-secondary-500 text-sm">Manage your Discovery Room bookings</p>
        </div>
        <button id="logoutBtn" class="px-4 py-2 btn-secondary text-white rounded-lg font-medium flex items-center gap-2 hover:shadow-md">
          <i class="fas fa-sign-out-alt"></i>
          Logout
        </button>
      </div>
      
      <div class="grid gap-6">
        <div id="bookingsTable" class="bg-white rounded-xl card p-6">
          <div class="flex justify-between items-center mb-4">
            <h3 class="text-lg font-semibold text-secondary-800">Upcoming Bookings</h3>
            <button id="newBookingBtn" class="px-3 py-1.5 bg-primary-100 text-primary-700 rounded-lg text-sm font-medium hover:bg-primary-200">
              <i class="fas fa-plus mr-1"></i> New Booking
            </button>
          </div>
          <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-secondary-200">
              <thead class="bg-secondary-50">
                <tr>
                  <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-secondary-500 uppercase tracking-wider">Date</th>
                  <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-secondary-500 uppercase tracking-wider">Time</th>
                  <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-secondary-500 uppercase tracking-wider">Room</th>
                  <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-secondary-500 uppercase tracking-wider">Purpose</th>
                  <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-secondary-500 uppercase tracking-wider">Status</th>
                  <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-secondary-500 uppercase tracking-wider">Actions</th>
                </tr>
              </thead>
              <tbody class="bg-white divide-y divide-secondary-200">
                <!-- Example booking row -->
                <tr>
                  <td class="px-4 py-3 whitespace-nowrap text-sm text-secondary-800">May 15, 2023</td>
                  <td class="px-4 py-3 whitespace-nowrap text-sm text-secondary-800">09:00 - 11:00</td>
                  <td class="px-4 py-3 whitespace-nowrap text-sm text-secondary-800">Discovery A</td>
                  <td class="px-4 py-3 text-sm text-secondary-800">Physics Workshop</td>
                  <td class="px-4 py-3 whitespace-nowrap">
                    <span class="px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800">Confirmed</span>
                  </td>
                  <td class="px-4 py-3 whitespace-nowrap text-sm text-secondary-800">
                    <button class="text-primary-600 hover:text-primary-800 mr-2"><i class="fas fa-edit"></i></button>
                    <button class="text-accent-600 hover:text-accent-800"><i class="fas fa-trash"></i></button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        
        <div id="queueTable" class="bg-white rounded-xl card p-6">
          <h3 class="text-lg font-semibold text-secondary-800 mb-4">Waiting List</h3>
          <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-secondary-200">
              <thead class="bg-secondary-50">
                <tr>
                  <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-secondary-500 uppercase tracking-wider">Request Date</th>
                  <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-secondary-500 uppercase tracking-wider">Preferred Date</th>
                  <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-secondary-500 uppercase tracking-wider">Room</th>
                  <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-secondary-500 uppercase tracking-wider">Status</th>
                </tr>
              </thead>
              <tbody class="bg-white divide-y divide-secondary-200">
                <!-- Example queue row -->
                <tr>
                  <td class="px-4 py-3 whitespace-nowrap text-sm text-secondary-800">May 10, 2023</td>
                  <td class="px-4 py-3 whitespace-nowrap text-sm text-secondary-800">May 20, 2023</td>
                  <td class="px-4 py-3 whitespace-nowrap text-sm text-secondary-800">Discovery B</td>
                  <td class="px-4 py-3 whitespace-nowrap">
                    <span class="px-2 py-1 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800">Pending</span>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modals would go here in a real implementation -->
  
  <script src="https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/12.0.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore.js"></script>
  <script>
    // Firebase config (same as index.html)
    const firebaseConfig = {
      apiKey:    "AIzaSyBKhgPEWHqW36Xg0Bx6qwsXq9Hnew0094o",
      authDomain:"school-booking-platform.firebaseapp.com",
      projectId: "school-booking-platform",
      storageBucket: "school-booking-platform.appspot.com",
      messagingSenderId:"673281572597",
      appId:     "1:673281572597:web:fe0ceec0054560f6258fbc",
      measurementId:"G-TVQ5PK5WZF"
    };
    firebase.initializeApp(firebaseConfig);
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Google Sign-In
      document.getElementById('googleSignInBtn').addEventListener('click', async function() {
        const statusDiv = document.getElementById('requestStatus');
        statusDiv.textContent = 'Signing in with Google...';
        statusDiv.className = 'text-sm text-center mt-1 text-blue-600';
        const provider = new firebase.auth.GoogleAuthProvider();
        try {
          const result = await firebase.auth().signInWithPopup(provider);
          const user = result.user;
          if (user && user.email) {
            // Check Firestore for teacher approval
            const teachersRef = firebase.firestore().collection('teachers');
            const snapshot = await teachersRef.where('email', '==', user.email.toLowerCase()).get();
            if (!snapshot.empty) {
              const teacherDoc = snapshot.docs[0].data();
              if (teacherDoc.status === 'approved') {
                statusDiv.textContent = 'Sign-in successful!';
                statusDiv.className = 'text-sm text-center mt-1 text-green-600';
                document.getElementById('authSection').classList.add('hidden');
                document.getElementById('portalSection').classList.remove('hidden');
              } else {
                statusDiv.textContent = 'Your account is pending approval. Please wait for admin approval.';
                statusDiv.className = 'text-sm text-center mt-1 text-yellow-600';
              }
            } else {
              statusDiv.textContent = 'No teacher account found for this email. Please sign up first.';
              statusDiv.className = 'text-sm text-center mt-1 text-red-600';
            }
          }
        } catch (err) {
          statusDiv.textContent = 'Google sign-in failed.';
          statusDiv.className = 'text-sm text-center mt-1 text-accent-600';
        }
      });

      // Sign Up Modal Logic
      document.getElementById('signUpLink').onclick = function(e) {
        e.preventDefault();
        document.getElementById('signUpModal').classList.remove('hidden');
        document.getElementById('signUpModal').classList.add('flex');
      };
      document.getElementById('cancelSignUpBtn').onclick = function() {
        document.getElementById('signUpModal').classList.remove('flex');
        document.getElementById('signUpModal').classList.add('hidden');
      };
      document.getElementById('signUpForm').onsubmit = async function(e) {
        e.preventDefault();
        const name = document.getElementById('signUpName').value.trim();
        const email = document.getElementById('signUpEmail').value.trim().toLowerCase();
        const subject = document.getElementById('signUpSubject').value.trim();
        const statusDiv = document.getElementById('signUpStatus');
        if(!name || !email || !subject) {
          statusDiv.textContent = 'All fields are required.';
          statusDiv.className = 'text-red-600';
          return;
        }
        try {
          await firebase.firestore().collection('teachers').add({
            name, email, subject, createdAt: new Date().toISOString(), status: 'pending'
          });
          statusDiv.textContent = 'Sign-up request submitted! You will be notified once approved.';
          statusDiv.className = 'text-green-600';
          document.getElementById('signUpForm').reset();
        } catch (err) {
          statusDiv.textContent = 'Failed to submit sign-up. Please try again.';
          statusDiv.className = 'text-red-600';
        }
      };
    });
  </script>
</body>
</html>